/*
ng-clamper - git@github.com:kevinchappell/ng-clamper.git
Version: 0.1.0
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
angular.module("ng-clamper",[]).directive("ngClamper",function(){"use strict";return{scope:{ngModel:"=ngModel",text:"=text"},restrict:"C",controller:"ClamperController as clamper"}}).controller("ClamperController",["$scope","$element","$timeout","$window",function(e,t,n,r){function l(){return p.ngModel.text||p.text||t[0].textContent}function o(){function e(){var e=p.ngModel.end||"&hellip;",n=parseInt(c,10),l=r.getComputedStyle(t[0],null).getPropertyValue("line-height").replace("px",""),o=function(){return{current:t[0].clientHeight||t[0].offsetHeight,closed:l*parseInt(c,10)}},s=function(){return Math.max(Math.ceil(o().current/l),0)},g=function(){return s()>n},f=function(n){for(var r=n.length-1;g();r--)t[0].innerHTML=u.strTruncate(n,r,e)};a&&(t[0].innerHTML=a,i||(i=g()),f(a),i?t.css({"max-height":"999px",overflow:"auto"}):t.css({"max-height":o().closed+"px",overflow:"hidden"}))}function n(){c=i?1e3:p.ngModel.clamp,i=!i,e()}a=l(),c=p.ngModel.clamp,p.$watch("ngModel",function(t,n){t.clamp!==n.clamp&&(c=t.clamp),e()},!0),t.bind("click",function(){p.$apply(n)})}var c,i,a,u=this,p=e;u.strTruncate=function(e,t,n){var r=e.length>t,l=r?e.substr(0,t-1):e,o=l.substring(0,Math.min(l.length,l.lastIndexOf(" ")));return o+n},n(o,0)}]);