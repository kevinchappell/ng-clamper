/*
ng-clamper - git@github.com:kevinchappell/ng-clamper.git
Version: 0.1.0
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
angular.module("ng-clamper",[]).directive("ngClamper",function(){"use strict";return{scope:{ngModel:"=ngModel",text:"=text"},restrict:"C",controller:"ClamperController as clamper"}}).controller("ClamperController",function(e,n,t,l){"use strict";function r(){return a.ngModel.text||a.text||n[0].textContent}function o(){function e(){var e=a.text,t=a.ngModel.end||"&hellip;",r=parseInt(a.ngModel.curClamp,10),o=l.getComputedStyle(n[0],null).getPropertyValue("line-height").replace("px",""),u=function(){return{current:n[0].clientHeight||n[0].offsetHeight,closed:o*parseInt(a.ngModel.curClamp,10)}},d=function(){return Math.max(Math.ceil(u().current/o),0)},i=function(){return d()>r},p=function(e){for(var l=e.length-1;i();l--)n[0].innerHTML=c.strTruncate(e,l,t)};e&&(n[0].innerHTML=e,a.ngModel.clamped||(a.ngModel.clamped=i()),p(e),a.ngModel.clamped?n.css({"max-height":"999px",overflow:"auto"}):n.css({"max-height":u().closed+"px",overflow:"hidden"}))}function t(){a.ngModel.clamped?a.ngModel.curClamp=1e3:a.ngModel.curClamp=a.ngModel.clamp,a.ngModel.clamped=!a.ngModel.clamped}a.text=r(),a.ngModel.curClamp=a.ngModel.clamp,a.$watch("ngModel",function(n,t){n.clamp!==t.clamp&&(a.ngModel.curClamp=n.clamp),e()},!0),n.bind("click",function(){a.$apply(t)})}var c=this,a=e;c.strTruncate=function(e,n,t){var l=e.length>n,r=l?e.substr(0,n-1):e,o=r.substring(0,Math.min(r.length,r.lastIndexOf(" ")));return o+t},t(o,0)});